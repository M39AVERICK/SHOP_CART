{% extends 'base.html' %}
{% load static %}

{% block title %}Order Confirmation{% endblock %}

{% block content %}
<!-- Order Success Section -->
<section id="order-success" class="order-success section py-5">
    <div class="container">
        <!-- Success Message -->
        <div class="section-title text-center" data-aos="fade-up">
            <h2 class="text-success fw-bold"><i class="fas fa-check-circle"></i> Order Placed Successfully!</h2>
        </div>

        <div class="row justify-content-center">
            <div class="col-md-8 text-center shadow-lg p-4 bg-white rounded">
                <!-- <img src="{% static 'img/su.pn<g' %}" alt="Success" class="img-fluid mb-4" style="max-width: 150px;"> -->
                <i class="fas fa-shopping-cart">Success</i>
                <h3 class="text-dark fw-bold">Thank you for your purchase! ðŸŽ‰</h3>
                <p class="text-muted">Your order has been placed successfully. You will receive a confirmation email shortly.</p>
                <p><i class="fas fa-truck"></i> <b>Estimated Delivery:</b> 3-5 Business Days ðŸšš</p>
                <hr class="my-4">

                <!-- Order Summary -->
                <h4 class="text-primary fw-bold"><i class="fas fa-receipt"></i> Order Summary</h4>
                <ul class="list-group my-3 shadow-sm rounded" id="order-items"></ul>
                <p class="mt-3 fw-bold text-dark"><i class="fas fa-wallet"></i> Total Paid: â‚¹<span id="total-amount" class="text-success">0</span></p>

                <!-- Buttons -->
                <a href="/" class="btn btn-primary mt-3"><i class="fas fa-shopping-bag"></i> Continue Shopping</a>
            </div>
        </div>
    </div>
</section>

<!-- JavaScript for Order Summary with Images -->
<script>
    document.addEventListener("DOMContentLoaded", function() {
        let orderData = JSON.parse(localStorage.getItem("cart")) || {};
        let total = 0;
        
        if (Object.keys(orderData).length === 0) {
            document.getElementById("order-items").innerHTML = '<p class="text-danger fw-bold">No items found in the order.</p>';
        } else {
            let i = 1;
            for (let item in orderData) {
                let name = orderData[item].name;
                let qty = orderData[item].qty;
                let price = orderData[item].price;
                let image = orderData[item].image || '{% static "img/default-product.png" %}'; // Default image if not available
                total += qty * price;

                let listItem = `
                    <li class='list-group-item d-flex align-items-center justify-content-between'>
                        <div class='d-flex align-items-center'>
                            <img src='${image}' alt='${name}' class='rounded me-3' style='width: 60px; height: 60px; object-fit: cover;'>
                            <div>
                                <b>${i}. ${name}</b><br>
                                <span class="badge bg-secondary">Qty: ${qty}</span>
                            </div>
                        </div>
                        <span class="text-success fw-bold">â‚¹${price}</span>
                    </li>`;
                document.getElementById("order-items").insertAdjacentHTML('beforeend', listItem);
                i++;
            }
        }
        
        document.getElementById("total-amount").textContent = total;
        localStorage.removeItem("cart"); 
    });
</script>

<!-- Bootstrap & Icons -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
{% endblock %}